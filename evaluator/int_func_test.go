package evaluator

import "testing"

func TestEvalIntFunctions(t *testing.T) {
	cases := []struct {
		inp    string
		expect string
	}{
		// float
		{`{{ 1.float() }}`, "1.0"},
		{`{{ 321.float().int() }}`, "321"},
		// abs
		{`{{ 1.abs() }}`, "1"},
		{`{{ -1.abs() }}`, "-1"},
		{`{{ (-1).abs() }}`, "1"},
		{`{{ 0.abs() }}`, "0"},
		{`{{ -999999.abs() }}`, "-999999"},
		{`{{ 999999.abs() }}`, "999999"},
		// str
		{`{{ 1.str() }}`, "1"},
		{`{{ 321.str() }}`, "321"},
		{`{{ (-1).str() }}`, "-1"},
		{`{{ (-9999999999).str() }}`, "-9999999999"},
		{`{{ 9999999999.str() }}`, "9999999999"},
		// len
		{`{{ 1.len() }}`, "1"},
		{`{{ 321.len() }}`, "3"},
		{`{{ -1.len() }}`, "-1"},
		{`{{ 0.len() }}`, "1"},
		{`{{ -9999999999.len() }}`, "-10"},
		{`{{ (-9999999999).len() }}`, "10"},
		{`{{ 9999999999.len() }}`, "10"},
		// decimal
		{`{{ 0.decimal() }}`, "0.00"},
		{`{{ 100.decimal() }}`, "100.00"},
		{`{{ 2352.decimal() }}`, "2352.00"},
		{`{{ 1000.decimal('_') }}`, "1000_00"},
		{`{{ 9000.decimal('_', 10) }}`, "9000_0000000000"},
		{`{{ 100.decimal('|', 0) }}`, "100"},
		{`{{ 100.decimal('|', 1) }}`, "100|0"},
		{`{{ (-100).decimal('|', 0) }}`, "-100"},
		{`{{ 1.decimal(',') }}`, "1,00"},
	}

	for i, tc := range cases {
		evaluationExpected(t, tc.inp, tc.expect, i)
	}
}
