# Release notes

## v3.0.0 (2026-01-30)
- üêõ Fixed incorrect file path in error messages when error happens inside of `@insert` directive.
- ‚ú® Improve memory and performance.
- ‚ú® Added global object. You can now add `GlobalData` to your configurations and access this data in your templates using `globals` object. For example: `globals.env`.
- ‚ú® Added `isDefined()` function which is available for all types. It returns true if variable is defined. [#56](https://github.com/textwire/textwire/issues/56)
- ‚ö†Ô∏è BREAKING CHANGE! Variable `global` is now reserved.
- ‚ö†Ô∏è BREAKING CHANGE! Fixed precedence for prefix expressions. Instead of `((!var).func())` we now have `(!(var.func()))`.
- ‚ö†Ô∏è BREAKING CHANGE! Changed default file extension from `.tw.html` to `.tw`. If you still want to support it, go to you configurations in `NewTemplate` or `Configure` and add field `TemplateExt:   ".tw.html"` to it.
- ‚ö†Ô∏è BREAKING CHANGE! Rename functions inside a parser. It should not be a breaking change unless you use Parser directly in some rare cases.
- ‚ö†Ô∏è BREAKING CHANGE! Minimal Go version support is version `1.25`.
- üßë‚Äçüíª Improve error handling when trying to use `@use`, `@insert`, `@reserve` or `@component` directives in simple `EvaluateString` or `EvaluateFile` function calls. These directives are only allowed inside template files with `textwire.NewTemplate`.
- ‚ú® Now you can add custom functions to objects as well with `RegisterObjFunc`.

## v2.7.1 (2026-01-23)
- üêõ Fixed incorrect file path in error messages when error happens inside of components

## v2.7.0 (2026-01-23)
- üßë‚Äçüíª Remove Container Engine support
- ‚ú® Added support for logical operators `&&` and `||`
- üêõ Fixed float convertion to string where 0 float was converted to 0.0. Now, float convertion to string works perfectly
- üêõ Fixed wrong convertion of ternary expression to string
- üêõ Fixed infinite loop bug that would appear when you have an illegal token like `{{ 4 ~ 3 }}`

## v2.6.8 (2025-06-19)
- ‚ú® Added Container Engine support to the project

## v2.6.7 (2025-06-14)
- üêõ Fixed incorrect snippet for `@break` autocomplete

## v2.6.5 (2025-06-14)
- üêõ Fixed not working autocomplete snippets

## v2.6.4 (2025-06-14)
- üßë‚Äçüíª Update completion item structure for LSP to make it treat completion inserts as snippets, not just as text

## v2.6.3 (2025-06-13)
- ‚ôªÔ∏è Code refactoring and improving error handling for lsp package
- üßë‚Äçüíª For LSP part, textwire now returns full insert text for autocompletion. E.g. instead of `@dump` it will autocomplete to `@dump()` and put the cursor inside `()`

## v2.6.2 (2025-06-11)
- üßë‚Äçüíª The `IsInLoop` function now always return result even when it found parsing errors

## v2.6.1 (2025-06-10)
- üßë‚Äçüíª Improve illegal token detection
- üßë‚Äçüíª The body of `@each`, `@for`, `@if`, `@insert` and `@slot` statements now can be empty

## v2.6.0 (2025-06-07)
- üßë‚Äçüíª Improve parser implementation by making it more resilient to syntax errors. It now produces an IllegalNode ast token. I'll be able to use it to detect illegal parts in a file and show it with a red squiggly line
- üßë‚Äçüíª Improve testing for the parser by adding more checks
- üßë‚Äçüíª Added validation for `@use` statement. Now, if you pass something other than type STR, it will print an error

## v2.5.9 (2025-05-29)
- üßë‚Äçüíª Added more tests to test `IsInLoop` function
- üêõ Fixed `IsInLoop` function

## v2.5.8 (2025-05-26)
- üêõ Fixed issue with `IsInLoop` function which wasn't working properly with multiline example

## v2.5.7 (2025-05-25)
- üêõ Fixed typos in LSP completions
- ‚ú® Added `IsInLoop` function to `lsp` API to check if the current cursor position is inside a loop
- ‚ú® Added `GetLoopObjFields` function to `lsp` API to get all the loop object fields

## v2.5.6 (2025-04-16)
- Added more data for LSP to handle auto completions
- Remove old Go version from the Github Actions file
- Replace `interface{}` with `any` keyword

## v2.5.5 (2025-04-09)
- Added more hover information for LSP server

## v2.5.4 (2025-04-07)
- Preparing Textwire for LSP server. Add improvements for better token search
- Fixed wrong end line number for tokens in the lexer

## v2.5.3 (2025-02-21)
- Added `meta` package for storing metadata about tokens. This will help in LSP implementation to get the hover information

## v2.5.2 (2025-02-20)
- Added `metadata` package to store metadata about tokens. This will help in LSP implementation to get the hover information

## v2.5.1 (2025-02-19)
- Changed `interface{}` to `any` in test files. Doesn't effect the functionality, just makes it more readable in development
- Added `token.Position` to each `token.Token` generated by the lexer. This will help in LSP implementation
- Refactor Lexer functionality to make it more readable and maintainable

## v2.5.0 (2025-01-26)
### ‚ö†Ô∏è Possibly Breaking Changes
- **Error when inserting unknown**: If you try to insert content that is not reserved in the layout, you will now receive an error message. Previously, the it was silently ignored.
- **Error when using duplicate inserts**: If you try to insert content multiple times with the same insert name, you will now receive an error message. Previously, the it was silently ignored.

### üêõ Bug Fixes
- **Incorrect Filepath in `@use` Statement**: Resolved an issue where invalid file paths in the `@use()` statement did not produce proper Textwire errors. Users will now see clear error messages for incorrect file paths.
- **Duplicate Unnamed Slots**: Fixed a bug where templates with duplicate unnamed slots silently used the first slot and ignored others. Errors will now be shown to alert users of this issue.
- **EvaluateFile Function**: Fixed the output of the `EvaluateFile` function to return the evaluated content as a string. Previously, it was bugged and was returning the absolute path of the file.

### ‚ú® New Features
- **Layout Shortcut**: You can now use a shortcut for referencing layouts. Instead of writing `@use("layouts/main")`, simply use `@use("~main")`. The `~` symbol is an alias for the `layouts/` directory.
- **Custom Error Page**: Now you can provide a path to a custom error page in the `textwire.NewTemplate` function by passing a config with the `ErrorPagePath` field. If an error occurs while rendering a template, the custom error page will be displayed instead of the [default error page](https://textwire.github.io/docs/v2/guides/error-handling#error-output-in-templates).
- **Improve Error Page**: Now you can set a `DebugMode` field in the config to `true` to see the error messages in the browser. This is useful for debugging purposes. Default is `false`. Plus, if you use VSCode, you can now click on the file path in the error message to open the file directly in the editor.
- **Custom Error Page**: Now you can provide a path to a custom error page through the `textwire.NewTemplate` function by passing a config with the `ErrorPagePath` field. If an error occurs while rendering a template, the custom error page will be displayed instead of the default error page.

## v2.4.1 (2025-01-23)
### üêõ Bug Fixes
- **Optional `@insert` Statement**: Fixed an issue where the `@insert` statement was mandatory even when a `@reserve` statement was defined in the layout. All `@insert` statements are now optional in such cases.

## v2.4.0 (2025-01-19)
### ‚ú® New Features
- **String Functions**: Added 3 new utility functions for strings:
    - `trimRight`: Removes trailing spaces.
    - `trimLeft`: Removes leading spaces.
    - `repeat`: Repeats a string a specified number of times.
- **Component Shortcut**: Simplify component usage with a new alias. Instead of writing `@component("components/post-card", { post })`, you can now write `@component("~post-card", { post })`. The `~` symbol is an alias for the `components/` directory.
- **Debugging Helper**: Added the `@dump` directive to output the value of a variable for debugging purposes.
- **Array Functions**: Added 2 new utility functions for arrays:
    - `append`: Adds an element to the end of an array.
    - `prepend`: Adds an element to the beginning of an array.

For more details, read the [blog post](https://textwire.github.io/blog/2025/01/10/textwire-v2.4.0).

## v2.3.0 (2024-12-29)
- üêõ Fixed bugs with function `len` for `STRING` type that was not handling Unicode correctly
- ‚ú® Added function `at` for `STRING` type that returns the character at the specified index
- ‚ú® Added function `first` for `STRING` type that returns the first characters of the string
- ‚ú® Added function `last` for `STRING` type that returns the last characters of the string
- ‚ú® Added function `then` for `BOOLEAN` type that returns the passed value if the boolean is true, otherwise returns `nil`. If second argument is passed, it returns the second argument if the boolean is false
- ‚ú® Added function `contains` for `ARRAY` type that returns true if the array contains the specified value, otherwise returns false

## v2.2.0 (2024-11-07)
- ‚ú® Added `truncate` function for `STRING` type
- ‚ú® Added `len` function for `INTEGER` type that returns the number of digits in the integer
- ‚ú® Added `decimal` function for `INTEGER` and `STRING` types that converts to a string with decimal points
- ‚ôªÔ∏è Added more tests for utility functions

## v2.1.1 (2024-10-24)
- üêõ Fixed bug where you couldn't pass `nil` to `textwire.NewTemplate` function

## v2.1.0 (2024-10-24)
### ‚ú® New Features
- For array literals, added `4` built-in functions: `rand`, `reverse`, `slice`, `shuffle`
- For integer literals, added `2` built-in functions: `abs`, `str`
- For float literals, added `5` built-in functions: `abs`, `ceil`, `floor`, `round`, `str`
- For string literals, added `3` built-in functions: `capitalize`, `reverse`, `contains`
- For boolean literals, added `1` built-in function: `binary`
- New error page while rendering a template. Instead of black screen we now get a simple error page with `Sorry! We‚Äôre having some trouble right now. Please check back shortly`

### üßë‚Äçüíª Improvements
- **Enhanced Error Handling for Built-in Functions**: Improved error messages when an incorrect argument type is passed to a built-in function. Users will now receive clear error messages indicating the type mismatch
- **Enhanced Error Handling for Custom Functions**: If a function is called on a type where it doesn‚Äôt exist, Textwire now provides a detailed error message specifying that the function is undefined for that type. For example, an error message might read: `[Textwire ERROR in /var/www/html/templates/home.tw:3]: function 'some' doesn't exist for type 'STRING'`
- **Enhanced Error Handling for Division by Zero**: Improved error messages for division-by-zero cases, replacing previous vague messages with more meaningful ones
- Remove `CONTRIBUTING.md` file

### üêõ Bug Fixes
- **Fixed Bug with Prefix Expression Precedence**. Resolved an issue where prefix expressions like `{{ -1.abs() }}` were not being processed correctly. Previously, the parser evaluated the expression as `{{ (-(1.abs())) }}`, resulting in an incorrect output of `-1`. Now, the parser correctly handles the precedence, evaluating it as `{{ ((-1).abs()) }}`

For more detailed information about this release, read the [Textwire v2.1.0 Release Notes](https://textwire.github.io/blog/2024/10/24/textwire-v2.1.0-release-notes)

## v2.0.0 (2024-10-18)
- ‚ôªÔ∏è [BREAKING CHANGE!] Moved `textwire.Config` to a separate package `config.Config`
- ‚ú® [suggested by @joeyjurjens](https://github.com/joeyjurjens) Added the ability to register your own custom functions for specific types and use them in your Textwire code like built-in functions. If you are upgrading from version 1, make these changes:
    1. Change all the imports from `github.com/textwire/textwire` to `github.com/textwire/textwire/v2`
    2. Run `go mod tidy` to update the dependencies
    3. Change the package name from `textwire.Config` to `config.Config` in your code if you use configuration and import `"github.com/textwire/textwire/v2/config"`. If you already have a package named `config`, you can alias the import like `twconfig "github.com/textwire/textwire/v2/config"`

## [Release Notes V1](.github/CHANGELOG-V1.md)
## [Emojis Meaning](.github/EMOJIS.md)
